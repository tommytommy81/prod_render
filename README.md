my_redirect_app/
├── app_db.py               ← Flask app
├── models.py               ← SQLAlchemy models
├── requirements.txt
├── render.yaml             ← Render deployment config
├── .env (optional, ignored)
└── Procfile                ← Tells Render how to run the app



This document describes the production environment for URL redirection in Render.

Repo: 		https://github.com/tommytommy81/prod_render
On Mac: 	/Users/administrator/MGME/Sandbox/Benny/prod_render
Webapp: 	https://dashboard.render.com/web/srv-d1rn7hripnbc73clh6qg

Documentation of the repo:

The web app is regulated by app_db.py, which contains the redirection logic.
It expects an URL containing an user_id:
- retrieves the user_id
- find the user_id in a postgre DB
- selected the voucher_url
- redirects to the voucher url

The database is generated by init_db.py
Reads voucher.csv
Creates instance/local.db
The sql must be migrated to postgre with the following bash commands:
1. generate to migrate.sql
    sqlite3 instance/local.db .dump > migrate.sql
2. Check that only fields 
	CREATE
    INSERT
    COMMIT
are present
3. Upload to Render
    psql "postgresql://redirect_db_twlc_user:z02xuAtWwIb9sAkCDBiLLWVYFCMH0LJx@dpg-d1rn917diees7393p6eg-a.oregon-postgres.render.com/redirect_db_twlc?sslmode=require" -f migrate.sql
4. Verify the content of the uploaded database
    psql "postgresql://redirect_db_twlc_user:z02xuAtWwIb9sAkCDBiLLWVYFCMH0LJx@dpg-d1rn917diees7393p6eg-a.oregon-postgres.render.com/redirect_db_twlc?sslmode=require" -c "SELECT * FROM vouchers;"

5. In Render: deploy the webapp

6. Navigate to the test link 

https://prod-render-wcuu.onrender.com/12345

